<!DOCTYPE html>
<!-- saved from url=(0068)https://christoph-rumpel.com/2020/11/laravel-real-time-notifications -->
<html lang="en" style="scroll-behavior: smooth;"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    

    <title>Laravel Real-Time Notifications - Christoph Rumpel</title>
    <meta name="description" content="Hi, I am Christoph Rumpel and this is my personal blog where I share my Laravel, PHP and business experiences.">
    <meta name="author" content="Christoph Rumpel">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="apple-touch-icon" sizes="180x180" href="https://christoph-rumpel.com/images/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://christoph-rumpel.com/images//favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="https://christoph-rumpel.com/images//favicon-16x16.png">
<link rel="manifest" href="https://christoph-rumpel.com/site.webmanifest">

    <!-- Styles -->
    <link href="./websocket_tutorial_files/main.css" rel="stylesheet">
        <meta property="og:url" content="https://christoph-rumpel.com/2020/11/laravel-real-time-notifications">
<meta property="og:type" content="article">
<meta property="og:title" content="Laravel Real-Time Notifications">
<meta property="og:description" content="In this post, we will take a look at how we can send real-time notifications with Laravel, the Laravel Websockets package, and Laravel Echo.">
<meta property="og:image" content="https://christoph-rumpel.com/images/blog/2020/laravel-real-time-notifications-banner.png">

<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@christophrumpel">
<meta name="twitter:title" content="Laravel Real-Time Notifications">
<meta name="twitter:description" content="In this post, we will take a look at how we can send real-time notifications with Laravel, the Laravel Websockets package, and Laravel Echo.">
<meta name="twitter:image" content="https://christoph-rumpel.com/images/blog/2020/laravel-real-time-notifications-banner.png">
    <style>
    /* latin-ext */
    @font-face {
        font-family: 'Bitter';
        font-style: normal;
        font-weight: 400;
        font-display: swap;
        src: local('Bitter Regular'), local('Bitter-Regular'), url(https://fonts.gstatic.com/s/bitter/v15/rax8HiqOu8IVPmn7cYxpLjpSm3LZ.woff2) format('woff2');
        unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
    }
    /* latin */
    @font-face {
        font-family: 'Bitter';
        font-style: normal;
        font-weight: 400;
        font-display: swap;
        src: local('Bitter Regular'), local('Bitter-Regular'), url(https://fonts.gstatic.com/s/bitter/v15/rax8HiqOu8IVPmn7f4xpLjpSmw.woff2) format('woff2');
        unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
    }
    /* latin-ext */
    @font-face {
        font-family: 'Bitter';
        font-style: normal;
        font-weight: 700;
        font-display: swap;
        src: local('Bitter Bold'), local('Bitter-Bold'), url(https://fonts.gstatic.com/s/bitter/v15/rax_HiqOu8IVPmnzxKl8DRhfsUjQ8Qad.woff2) format('woff2');
        unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
    }
    /* latin */
    @font-face {
        font-family: 'Bitter';
        font-style: normal;
        font-weight: 700;
        font-display: swap;
        src: local('Bitter Bold'), local('Bitter-Bold'), url(https://fonts.gstatic.com/s/bitter/v15/rax_HiqOu8IVPmnzxKl8AxhfsUjQ8Q.woff2) format('woff2');
        unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
    }
</style>
    <!-- Styles -->

    <!-- Head Script -->
            <!-- Fathom - beautiful, simple website analytics -->
        <script src="./websocket_tutorial_files/script.js.download" site="DEPGUYJS" defer=""></script>
        <!-- Fathom -->

        <script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"Blog","name":"Christoph Rumpel","description":"Hey, I'm Christoph. I code. I write about code. I teach how I write code. I talk at conferences about how I teach to code.","image":"https:\/\/christoph-rumpel.com\/images\/cr.png","url":"https:\/\/christoph-rumpel.com"}</script>    

    <script defer="" src="./websocket_tutorial_files/app.js.download"></script>

    <!-- Head Script -->

</head>

<body class="bg-bgBlue">

<div x-data="{ showPromoBanner: $persist(true)}">
    <div class="relative bg-highlightBlue" x-show="showPromoBanner" x-transition:enter="transition ease-out duration-300" x-transition:enter-start="opacity-0 transform" x-transition:enter-end="opacity-100 transform" x-transition:leave="transition ease-in duration-300" x-transition:leave-start="opacity-100 transform" x-transition:leave-end="opacity-0 transform">
        <div class="max-w-screen-xl mx-auto py-6 px-3 sm:px-6 lg:px-8">
            <div class="pr-16 sm:text-center sm:px-16">
                <p class="font-medium text-textBlue">
        <span class="md:hidden">
         Working with PhpStorm?
        </span>
                    <span class="hidden md:inline">
         Working with PhpStorm?
        </span>
                    <span class="block sm:ml-2 sm:inline-block">
          <a href="https://masteringphpstorm.com/" class="text-textBlue font-bold underline">
            â†’ Check my Mastering PhpStorm video course
          </a>
        </span>
                </p>
            </div>
            <div class="absolute inset-y-0 right-0 pt-1 pr-1 flex items-start sm:pt-1 sm:pr-2 sm:items-start">
                <button @click="showPromoBanner = false" type="button" class="flex p-2 text-textBlue hover:text-white rounded-md hover:bg-textBlue focus:outline-none focus:bg-textBlue transition ease-in-out duration-150" aria-label="Dismiss">
                    <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>
</div>


<div class="container mx-auto  max-w-5xl p-8 md:p-12">
    <header class="flex flex-col lg:flex-row items-center mb-8 lg:mb-32">
        <a href="https://christoph-rumpel.com/" class="block logo mb-8 sm:mb-12 lg:mb-0 text-link">
    <div class="flex justify-center items-center font-display font-bold">
        <svg class="w-24 h-12" id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 43.45 39.5"><defs><style>.cls-1{isolation:isolate;}.cls-2{fill:#0f1b61;}</style></defs><title>CR</title><g id="Page-1"><g id="_1280x2048" data-name="1280x2048"><g id="CR" class="cls-1"><g class="cls-1"><path class="cls-2" d="M21,5.58a.83.83,0,0,1,0,.55,3,3,0,0,1-.44.5,2,2,0,0,1-.38-.53.65.65,0,0,0-.72-.33,2.65,2.65,0,0,1,.05.57c-.07-.06-.11-.09-.15-.09s-.08,0-.14-.1a1,1,0,0,0-.55-.26A2,2,0,0,0,18,6a5,5,0,0,0-1,.41,5.36,5.36,0,0,0-.94.6,10,10,0,0,0-1.41,1.17,8.54,8.54,0,0,0-1.18,1.47c-.35.45-.7.9-1,1.37a10.35,10.35,0,0,0-.89,1.46c-.19.35-.4.7-.62,1s-.44.68-.63,1a7.83,7.83,0,0,0-.33.75c-.1.24-.21.49-.34.74-.38.9-.76,1.8-1.13,2.71a24.88,24.88,0,0,0-.93,2.76c-.2.61-.36,1.22-.51,1.83a10.53,10.53,0,0,0-.26,1.87A3.21,3.21,0,0,0,7,26.41a9.36,9.36,0,0,0,.48,1.15,1.34,1.34,0,0,0,.41.6,5.71,5.71,0,0,0,.6.41.85.85,0,0,0,.82.05v0l.28-.19.29-.19h0a4.84,4.84,0,0,0,1-1l.86-1.15.48-.77.48-.77c.1-.16.2-.3.29-.43a3.88,3.88,0,0,1,.34-.38.58.58,0,0,1,.24-.15.72.72,0,0,0,.24-.14c-.26.45-.49.88-.7,1.3s-.44.84-.69,1.29l-.15.43.24-.21a1.79,1.79,0,0,0,.24-.22c.23-.35.44-.7.65-1.05s.42-.71.65-1.06.43-.71.62-1.08.39-.73.58-1.08a.5.5,0,0,1,.72-.29.6.6,0,0,1,.05.24A1,1,0,0,0,16,22a1,1,0,0,0,.44-.43,4.58,4.58,0,0,1,.38-.63,2.47,2.47,0,0,0-.05.34v.19a2.13,2.13,0,0,1,0,.27.88.88,0,0,0,0,.21A2.51,2.51,0,0,1,17,21.8l.39-.24c-.07.19-.12.38-.17.55a3.81,3.81,0,0,1-.17.51.7.7,0,0,0,.41-.36.68.68,0,0,1,.5-.36,3.52,3.52,0,0,1-.21.52,5.29,5.29,0,0,0-.22.53.37.37,0,0,0,.19.12l.2.07a.8.8,0,0,1,.19.92l-.46,1c-.14.33-.29.68-.45,1a5.15,5.15,0,0,1-.32.62,1.1,1.1,0,0,0-.12.68.7.7,0,0,1,.05.76,21.24,21.24,0,0,1-1,2,9.31,9.31,0,0,1-1.29,1.85c-.2.19-.4.38-.6.55a3.39,3.39,0,0,1-.7.46l-.65.31-.69.36a7.12,7.12,0,0,1-1,.41,3.27,3.27,0,0,1-1,.17,1.45,1.45,0,0,0-.43.05,3.53,3.53,0,0,0-.43.14,5.25,5.25,0,0,1-4-.72l-.55-.31-.5-.31a4.75,4.75,0,0,1-1-.92c-.31-.35-.6-.7-.89-1a3,3,0,0,1-.17-.41c-.05-.14-.1-.3-.17-.46v.05H1.48v0a.29.29,0,0,1,.19-.05.77.77,0,0,1-.19-.14v0a.82.82,0,0,1-.41-.48C1,29.53,1,29.34.9,29.14l-.14-.28A.55.55,0,0,0,1,28.28a4,4,0,0,0-.24-.58.76.76,0,0,1,0-.91v-.05a2.2,2.2,0,0,1-.09-.21c0-.08-.07-.15-.1-.22a22.23,22.23,0,0,1-.14-3.26,15.94,15.94,0,0,1,.43-3.27,3.53,3.53,0,0,0,.14-.43A1,1,0,0,1,1.14,19a4.12,4.12,0,0,1,.15.48,3.11,3.11,0,0,0,.33-.89c.07-.3.13-.6.2-.89a.63.63,0,0,0-.05-.21c0-.08-.07-.17-.1-.27s0,0,0,0a0,0,0,0,1,0,0A7.62,7.62,0,0,1,2,15.78c.16-.47.32-.92.48-1.37s.51-1.08.77-1.61.51-1.06.76-1.61.64-1.14.94-1.7.6-1.13.89-1.71a.29.29,0,0,0,.09-.21A1,1,0,0,1,6,7.3v0l.22-.19a2,2,0,0,0,.21-.19A21.29,21.29,0,0,1,8.34,4.18a13.19,13.19,0,0,1,1.92-1.89A9.52,9.52,0,0,1,12.62.92,6.33,6.33,0,0,1,13.74.63,2.41,2.41,0,0,1,15,.78a1,1,0,0,1,.21-.1.28.28,0,0,1,.22,0,1.45,1.45,0,0,0,.72.1c.22,0,.46-.08.72-.15a2.19,2.19,0,0,1,.82-.14,3,3,0,0,1,.45.12,1.2,1.2,0,0,1,.46.31,3,3,0,0,0,.74.55A5.59,5.59,0,0,1,20.1,2a2.06,2.06,0,0,0,.34,1.53.57.57,0,0,1,.12.53.57.57,0,0,0,.12.53,1.39,1.39,0,0,1,.19.5A2.15,2.15,0,0,0,21,5.58ZM.66,26.74a.59.59,0,0,0,.12-.31A.58.58,0,0,0,.62,26a2.49,2.49,0,0,0,0,.41A1.72,1.72,0,0,1,.66,26.74ZM1,24.15a.16.16,0,0,1,0-.09A.44.44,0,0,0,1,24L1,23.91s0,0,0-.05A.31.31,0,0,0,.81,24Zm.15-4c-.16.09-.15.24,0,.43A1.3,1.3,0,0,0,1.1,20.17Zm0-.05a.69.69,0,0,0,.15-.67A.44.44,0,0,0,1.14,20.12Zm0-1.25a3.86,3.86,0,0,1,.1-.84,2.13,2.13,0,0,1,.38-.79,3.19,3.19,0,0,1-.48,1.63v0Zm.24,11,.1-.1a.77.77,0,0,0-.1-.24s0,.05,0,.05-.05,0-.05,0A.93.93,0,0,0,1.38,29.82ZM3.16,13.5a.2.2,0,0,1,.14,0,1.76,1.76,0,0,1,.1-.43.32.32,0,0,0-.12.1.31.31,0,0,1-.12.09ZM3.45,13,3.4,13h.05Zm.19,12.24a.57.57,0,0,0,.19-.51,3.78,3.78,0,0,1-.05-.64,1,1,0,0,0-.21.64A3.92,3.92,0,0,0,3.64,25.21Zm0,.43,0-.05,0-.05s0,.05-.05.05Zm4.75,5.52a4.44,4.44,0,0,0,.55.1.73.73,0,0,0,.36-.2A1.15,1.15,0,0,0,8.94,31a2.77,2.77,0,0,0-.55.14Zm3.27-5.86h0v0Zm.33-.52h0v0Zm1.35-23a1.53,1.53,0,0,1,.26-.08c.08,0,.14-.08.17-.21l-.27,0C13.42,1.49,13.37,1.58,13.34,1.74Zm.72-.39s0-.05,0-.05,0,0,0,0H14a1,1,0,0,1-.24.14h.29Zm-.29,22.13.05-.05v.05ZM14.15,22h0ZM15,.78s0,0,0,0h0ZM16.7,27.46a.65.65,0,0,0-.15.2l.1,0a.46.46,0,0,1,0-.14A.17.17,0,0,0,16.7,27.46Zm0-5.37s0,0,0,.05v-.05Zm.57-18.24a.84.84,0,0,0,.87-.29c-.29-.16-.49-.22-.6-.17S17.34,3.59,17.27,3.85Zm3,0a3.34,3.34,0,0,0-.63-1A.67.67,0,0,0,19,2.84a2.79,2.79,0,0,1,.07.38,2.7,2.7,0,0,0,.08.39,3,3,0,0,1,.4.19c.12.06.24,0,.36-.14Z" transform="translate(-0.32 -0.49)"></path><path class="cls-2" d="M19.19,30.1a2.18,2.18,0,0,1,0-.57.81.81,0,0,1,.26-.53,3,3,0,0,0-.12.55A1.88,1.88,0,0,1,19.19,30.1ZM43.48,11.72c-.07-.16-.12-.31-.17-.46s-.1-.29-.17-.45a.45.45,0,0,0-.24-.19,5.11,5.11,0,0,1,.15.74,6.85,6.85,0,0,0,.14.74,5.81,5.81,0,0,1,0,2.12.62.62,0,0,0-.19-.15,1.64,1.64,0,0,0-.14,1.2c.06-.13.12-.29.19-.48a2,2,0,0,1,0,1.54,4.09,4.09,0,0,0-.34,1c-.06.32-.12.65-.19,1v-.05A7.49,7.49,0,0,1,41.7,21a5,5,0,0,1-.31.56,1.09,1.09,0,0,1-.45.4.31.31,0,0,0-.15.17.74.74,0,0,1-.14.22,5.08,5.08,0,0,0-.44.5c-.12.18-.25.35-.38.51l0,0,0,0c-.16-.1-.27-.05-.33.14a1,1,0,0,1-.68.43,1,1,0,0,1-.53.53,12.66,12.66,0,0,1-1.65.82c-.56.22-1.13.43-1.7.62-.32.13-.64.24-.94.34s-.62.2-.94.33l-.24.1-.24.14a1.33,1.33,0,0,0,.63.82l.67.55.67.55a5.9,5.9,0,0,0,.46.43l.45.44a.38.38,0,0,1-.36-.08,1.33,1.33,0,0,0-.26-.21l-.46-.36-.45-.36a.65.65,0,0,0,.38.77,3.54,3.54,0,0,1,1,.81,7.38,7.38,0,0,0,.94.91c.23.2.43.4.63.6a2,2,0,0,0,.76.51.36.36,0,0,1,.29.38l.14.15h-.14v0a.25.25,0,0,0,.1.08s.06,0,.09.12l-.05,0h.05l.08.09a.17.17,0,0,0,.07.1h0l.48.58.48.57c.09.1.19.19.29.29a2.44,2.44,0,0,0,.33.29H40V35H40c.1.13.19.26.27.38l.26.39.68.86q.33.43.72.87a1.16,1.16,0,0,1,.23.52c0,.2.07.42.1.68a2.18,2.18,0,0,0-.33-.15l-.34-.09a1.23,1.23,0,0,0,.19.38,5.74,5.74,0,0,0-.36.5,5.62,5.62,0,0,1-.41.56,3.18,3.18,0,0,1-.74.09,1.6,1.6,0,0,1-.74-.19v.05l0-.05-.15-.14c0-.07,0-.11-.07-.12a.54.54,0,0,1-.07-.12.6.6,0,0,1,0,.24,3.32,3.32,0,0,1-.69-.17,1.74,1.74,0,0,1-.6-.41l-.72-.6q-.35-.27-.72-.6v0l-.1.07a.32.32,0,0,0-.1.12v.1a.75.75,0,0,1-.5-.08,3.54,3.54,0,0,1-.41-.26c-.45-.35-.9-.68-1.37-1s-.92-.64-1.36-1a21.18,21.18,0,0,1-1.68-1.32c-.55-.46-1.11-.92-1.68-1.37-.17-.12-.32-.24-.46-.36a.91.91,0,0,1-.31-.45.09.09,0,0,0,.07,0l.07,0a.27.27,0,0,1,.34-.14,4.71,4.71,0,0,0,.48.28,5.71,5.71,0,0,0-1-1,4.06,4.06,0,0,0-1.2-.68.3.3,0,0,1,.09.2.15.15,0,0,0,.1.14,2.51,2.51,0,0,0,.31.26l.36.27a.77.77,0,0,1,.14.19h-.14l.14.14v.15a.93.93,0,0,1-.43-.22l-.38-.36-.48-.45c-.16-.15-.35-.32-.58-.51,0-.06,0-.17,0-.33a4.33,4.33,0,0,1,0-.53.63.63,0,0,0-.35.33l-.17.44-.39,1.65c-.13.56-.27,1.11-.43,1.66a17,17,0,0,1-.62,1.68,1.05,1.05,0,0,1-.72.5,1.3,1.3,0,0,1-1,0,1.33,1.33,0,0,1-.72-.39.27.27,0,0,0-.27,0,.59.59,0,0,1-.21,0V34.47a.9.9,0,0,0-.39.67.87.87,0,0,1-.43.68c-.16-.07-.24-.13-.24-.2a.45.45,0,0,1-.07-.33.33.33,0,0,0-.07-.29.59.59,0,0,0-.27-.22c-.11,0-.16-.15-.16-.31a.38.38,0,0,0-.05-.24.78.78,0,0,1-.46-.62c0-.26,0-.51-.07-.77a6,6,0,0,1,.34-2.54A5,5,0,0,0,19.86,29a25.92,25.92,0,0,1,.68-3.12c.28-1,.55-2,.81-3.07.07-.38.14-.78.22-1.18s.15-.79.21-1.17v.05a1.28,1.28,0,0,1,.1-.17l.1-.17c.19-.64.39-1.29.6-1.94s.42-1.31.64-1.95q.11-.44.24-.84c.1-.27.2-.53.29-.79a.25.25,0,0,0-.31,0l-.22.22c0-.06-.06-.14-.09-.22a.26.26,0,0,1,0-.21,11.87,11.87,0,0,1,.6-1.8c.24-.56.5-1.13.79-1.71-.13.45-.26.89-.41,1.32a7.59,7.59,0,0,0-.31,1.37,1,1,0,0,0,.67-.81,5,5,0,0,1,.79-1.73,13.15,13.15,0,0,0,1-1.59,2.84,2.84,0,0,1,.29-.19,1,1,0,0,1,.12.27.59.59,0,0,0,.12.26c.09-.22.19-.44.28-.65a4.42,4.42,0,0,1,.34-.6h.1a4.3,4.3,0,0,1,.09.72h.19A1.69,1.69,0,0,0,28,9a1.69,1.69,0,0,0,.12-.28,3.79,3.79,0,0,1,1-1.88,7.4,7.4,0,0,0-.77-.48,3,3,0,0,1,.46-.14,3.26,3.26,0,0,0,.45-.14,2.39,2.39,0,0,0-1.87-.48l-.43.07a.72.72,0,0,1-.38-.07l-.41-.12a.94.94,0,0,0-.36-.08.86.86,0,0,0-.39,0,1.24,1.24,0,0,1-.38,0,.83.83,0,0,1-.17-.65,2.15,2.15,0,0,1,.31-.6,3.94,3.94,0,0,1,3.41-1.53c.35,0,.72.05,1.11.05s.75,0,1.1,0a.75.75,0,0,0,.29,0L31,2.5l-.14-.24a6.16,6.16,0,0,1,.84.24c.24.1.48.2.74.29l.87.43a1.34,1.34,0,0,0,.43.12,1,1,0,0,0,.48-.07,1.63,1.63,0,0,0-.75-.5,2.42,2.42,0,0,1-.74-.36,1.77,1.77,0,0,0-.82-.27,1.07,1.07,0,0,1-.76-.4,3.82,3.82,0,0,1,2.08-.1,11,11,0,0,1,2,.67,4.71,4.71,0,0,1,.45.22l.46.26c.25.13.53.26.82.39s.57.27.86.43v.05a.77.77,0,0,1,.19.14h-.19a.28.28,0,0,1,.19.19V4l.17.17.17.17a.92.92,0,0,1,.53.14c.12.1.25.21.38.34s.38.38.55.57a2.89,2.89,0,0,0,.65.53,1,1,0,0,1,.26.27c.08.11.16.21.22.31a1.32,1.32,0,0,0,.34.38,8.12,8.12,0,0,1,.72.87,8.54,8.54,0,0,1,.69,1.15c.21.41.39.82.55,1.22a6.89,6.89,0,0,1,.34,1.08ZM19.43,29v0Zm1.49,3.36A.72.72,0,0,1,21,32a.13.13,0,0,1-.1,0,.41.41,0,0,0-.05.19.34.34,0,0,1-.05.19Zm.24,4h.05v0Zm.24-.57a.12.12,0,0,1,0-.07.1.1,0,0,0,0-.08A.21.21,0,0,1,21.4,35.77Zm.05-2.07.26-.12a.18.18,0,0,0,.12-.12c.13-.16.11-.35,0-.57-.06.13-.12.25-.16.36A4,4,0,0,0,21.45,33.7Zm.33-.81a1.8,1.8,0,0,1,.27-.07c.08,0,.08-.11,0-.27A2,2,0,0,1,21.78,32.89Zm.15,2.4s.05,0,.05,0,0,0,0,0l-.09-.1s-.05.06-.05.08a.18.18,0,0,1-.05.07ZM22,17.67s0,0,.05-.09l.05-.1v.14Zm.1-.24.05-.05-.05.1Zm.67-2.21c.07-.22.19-.33.39-.33l-.36,1c-.12.31-.24.63-.36,1a1,1,0,0,0-.15.26,1.34,1.34,0,0,1-.14.26c.09-.35.19-.71.29-1.08A11.12,11.12,0,0,1,22.79,15.22Zm.39-.33s0-.05,0-.05v.05Zm.57-1a.48.48,0,0,0-.14.41.59.59,0,0,0,.14.26Zm1.2-3.5-.09,0,0,0Zm.63,23a.21.21,0,0,0,0-.15v.15l0,.05Zm0-.15A1.08,1.08,0,0,0,25.7,33a.49.49,0,0,1,.07-.19v0a.49.49,0,0,0-.07.19A1.08,1.08,0,0,1,25.62,33.22ZM26,32.07a.84.84,0,0,1-.24.72,1.52,1.52,0,0,0,.12-.36A1,1,0,0,1,26,32.07ZM27.59,9.61a0,0,0,0,0-.05,0,.14.14,0,0,1,.05.1Zm.05-1.68s0,.05,0,.05,0,0,0,0V7.93ZM28,31.69v0Zm.19.48a.44.44,0,0,0,.1.12.3.3,0,0,1,.1.07v0h-.05a.53.53,0,0,0-.15-.19Zm.2-11.09v0h-.1a0,0,0,0,0,.05,0ZM37,15.13a2.06,2.06,0,0,0,0-.55c0-.18,0-.36,0-.56a.26.26,0,0,1-.14.05l-.15,0a.26.26,0,0,0,.05-.14.43.43,0,0,1,0-.15,1.67,1.67,0,0,0-.14-1.49.11.11,0,0,1,0-.09.5.5,0,0,0,0-.15v0a.49.49,0,0,0,.1-.52,1.8,1.8,0,0,0-1-1,.8.8,0,0,1,0,.33,3.4,3.4,0,0,0-.29-.33h.34A1.24,1.24,0,0,0,35,10a.26.26,0,0,1-.14-.09.14.14,0,0,1,0,.07.08.08,0,0,0,0,.07l.07,0a.1.1,0,0,0,.08,0,.2.2,0,0,0,0,.14L34.79,10V9.85a1,1,0,0,1-.12-.15.25.25,0,0,0-.12-.09C34,9.35,33.48,9.09,33,8.82s-1-.54-1.54-.8A1.64,1.64,0,0,1,31,7.78c-.13-.09-.27-.19-.43-.28l-.31-.2a.49.49,0,0,0-.41,0,3,3,0,0,0,0,.6,1.13,1.13,0,0,1,0,.56,5.37,5.37,0,0,0-.19,1.41v1.42a4.32,4.32,0,0,1,0,.5,1.24,1.24,0,0,0,.07.51,3.26,3.26,0,0,1,.12.74,3.68,3.68,0,0,1,0,.74c0,.16,0,.34,0,.53a5.63,5.63,0,0,0,0,.58h0c-.22.89-.45,1.79-.67,2.69s-.45,1.8-.67,2.73a.9.9,0,0,0-.05.34,1.6,1.6,0,0,0,.53-.19,2.25,2.25,0,0,1,0,.4c0,.12,0,.24,0,.36.77-.25,1.5-.52,2.21-.81s1.39-.59,2.06-.91c.29-.13.56-.27.82-.41a4,4,0,0,0,.72-.55c.22-.26.45-.52.67-.8A10.5,10.5,0,0,1,36,17c.13-.16.24-.21.34-.14v0a1.54,1.54,0,0,0,.09-.24,1.45,1.45,0,0,1,.1-.24l0-.05,0,.05a.8.8,0,0,0,.31-.55A5.48,5.48,0,0,1,37,15.13ZM29.13,5.29s0,0,.05,0l0,0s0,0,0,0,0,0-.05,0Zm.14.77c.1.22.24.22.43,0Zm.24-.39c.07.13.15.19.24.17a1.15,1.15,0,0,1,.24,0,.67.67,0,0,0-.24-.08A.84.84,0,0,1,29.51,5.67Zm.72,27.84a1.34,1.34,0,0,0,.29.15l.38.14a4.37,4.37,0,0,0-.55-.72,1.29,1.29,0,0,0-.55-.24,1.66,1.66,0,0,0,.22.34,1.71,1.71,0,0,1,.21.33v0Zm.1-31.39a.11.11,0,0,0,0,.1.17.17,0,0,0-.15-.05,0,0,0,0,1,.05,0Zm.81,17.57h.1l-.1,0Zm.63-.29v.05h-.05ZM33.54,6.73A1.69,1.69,0,0,0,31.77,6a9.46,9.46,0,0,1,.86.48A2,2,0,0,0,33.54,6.73Zm.39,21.84q-.43-.39-.87-.72l-.91-.72-.33-.1c.57.58,1.15,1.11,1.72,1.59a.69.69,0,0,0,.2,0ZM32.2,19.11h.09l-.09.05Zm.53-.29a0,0,0,0,1,.05.05s0,0,0,.05h-.1S32.73,18.89,32.73,18.82Zm0,16.42,0-.1v.1Zm.48-16.7-.05.09v-.09Zm0-.05,0,.05v-.05Zm0,0a.88.88,0,0,1,.62-.29,2.77,2.77,0,0,0-.29.22A.35.35,0,0,1,33.26,18.49Zm1.53-1.25a.3.3,0,0,1,.1-.07L35,17.1H35l-.05,0a.53.53,0,0,1-.19.15.77.77,0,0,0-.14.19,1,1,0,0,1-.19.14.87.87,0,0,1-.15.2.28.28,0,0,0-.07.09.32.32,0,0,1-.12.1l-.19.19h0a.31.31,0,0,1,.09-.12.32.32,0,0,0,.1-.12.28.28,0,0,1,.09-.07l.1-.07a.46.46,0,0,0,.07-.1.58.58,0,0,1,.08-.1l.09-.07a.3.3,0,0,0,.1-.07.54.54,0,0,1,.07-.12ZM35,3.18l0,0v0Zm1.35,34.75a.27.27,0,0,0-.2.19A3.2,3.2,0,0,1,35,37.21,1.9,1.9,0,0,1,36.38,37.93ZM35.46,3.42l0,0,0-.05Zm.2,26.4a.33.33,0,0,0-.2-.2v0h0a.77.77,0,0,0,.15.19l0,.05Zm1.53,1.1a3.33,3.33,0,0,1-1.49-1.1A4.58,4.58,0,0,1,37.19,30.92Zm-1.06-19.1h0v0Zm0,0a.35.35,0,0,1,.34.28,1,1,0,0,0-.17-.14A1.53,1.53,0,0,1,36.18,11.82Zm.1,26.64a.62.62,0,0,0-.1-.24.48.48,0,0,0,.08.12l.07.12h0Zm.38-24.34v0Zm.63,16.94-.1-.09v0a0,0,0,0,0,.05,0Zm.29.29-.29-.29.33.24Zm0-14.54.05-.12a.42.42,0,0,1,0-.12h-.14c-.07.06-.1.11-.1.14a0,0,0,0,0,.05.05s0,0,0,0S37.59,16.81,37.62,16.81Zm.48,15.93s-.05,0-.05,0h.05Zm.15.34a.17.17,0,0,1-.07-.1l-.08-.09v-.15a.3.3,0,0,1,.48,0l.05,0v0a1.59,1.59,0,0,1,.82.63.84.84,0,0,0-.24-.07.67.67,0,0,1-.24-.08v.05h-.19v-.05H39a.62.62,0,0,1-.19-.14.25.25,0,0,1-.08-.1.28.28,0,0,0-.07-.09v0h-.05v.19Zm0-18.19v-.05l-.05.05Zm.58,18.19v.14l-.15-.14Zm.52,6.58.15.14c-.16.16-.28.11-.34-.14Zm.15-5.91c-.13,0-.13-.08,0-.14Zm0-.33v-.05s0,.05,0,.05Zm0,0a1.66,1.66,0,0,1,.4.21c.12.08.14.23.07.46l.05,0H40v0l-.14-.15-.19-.19-.14-.14h0v0l0,0Zm0,.33h.14v.15Zm.33.19v.15l-.14-.15Zm0-11.8q.29,0,.36-.15a1.28,1.28,0,0,1,.17-.33,1.26,1.26,0,0,0-.36.09S39.89,21.91,39.83,22.14Zm.1,12.19a.12.12,0,0,1,0-.1.14.14,0,0,0-.05-.09H40a.15.15,0,0,1,0,.09A.18.18,0,0,0,39.93,34.33Zm0,.48V35l-.14-.14Zm.44-.39a1.14,1.14,0,0,1-.27,0,.82.82,0,0,0-.21,0v-.05a.85.85,0,0,0,.26.05.54.54,0,0,1,.22,0h0Zm1.34-14.54a1,1,0,0,1,.1-.17L42,19.5a2.21,2.21,0,0,1-.48,0,.68.68,0,0,0,.07-.24.85.85,0,0,1,.08-.24,1.54,1.54,0,0,0,.09-.24.51.51,0,0,0-.09-.38c-.23.51-.45,1-.65,1.46s-.43.92-.65,1.37a.26.26,0,0,0,0,.19,1.36,1.36,0,0,1,0,.2,4.25,4.25,0,0,0,1-1.49.69.69,0,0,1,.24-.24v-.19l.14.14ZM40.46,34.42a.56.56,0,0,1,.19.34l-.1-.17A1.31,1.31,0,0,1,40.46,34.42Zm.19.34.14.14a.13.13,0,0,0-.07,0s0,0-.07,0Zm.24.29v0h0s0,0,0,0,0,0,0-.05,0,.05,0,.05,0,0,0,0h0Zm.72-21.89a.16.16,0,0,0,0,.14h.09v-.24C41.66,13.16,41.61,13.19,41.61,13.16Zm.62,5.47a1,1,0,0,1,.1-.17,1.14,1.14,0,0,0,.09-.16c-.16,0-.25.05-.26.07S42.17,18.47,42.23,18.63Zm.67-8.06a.21.21,0,0,0,.05-.15.14.14,0,0,0,0-.07s0,0,0-.12a.14.14,0,0,1-.09,0,.16.16,0,0,0,0,.14s0,.06,0,.08A.12.12,0,0,1,42.9,10.57Zm.53,4.17c-.06.13-.1.2-.12.2a1.48,1.48,0,0,1-.26-.15l.19,0A.63.63,0,0,1,43.43,14.74Zm0-3v0h0A0,0,0,0,1,43.48,11.72Zm0,3a.19.19,0,0,0,0-.1v.1Zm0,0,0,0v0Zm.19-1.4a1.22,1.22,0,0,1-.21-.76c0-.26,0-.52,0-.77l.1.07.09.07a3.18,3.18,0,0,1,.1.7A3,3,0,0,1,43.67,13.3Zm-.09.92a1.92,1.92,0,0,1-.1.38,1.25,1.25,0,0,1,.05-.38Z" transform="translate(-0.32 -0.49)"></path></g></g></g></g></svg>
    </div>
</a>
        <nav class="w-full">
    <ul class="flex flex-row justify-center flex-wrap lg:justify-end">
        <li class="font-display text-2xl px-4"><a class="text-link" href="https://christoph-rumpel.com/">Blog</a></li>
        <li class="font-display text-2xl px-4"><a class="text-link" href="https://christoph-rumpel.com/products">Products</a></li>
        <li class="font-display text-2xl px-4"><a class="text-link" href="https://christoph-rumpel.com/speaking">Speaking</a></li>
        <li class="font-display text-2xl px-4"><a class="text-link" href="https://christoph-rumpel.com/uses">Uses</a></li>
        <li class="font-display text-2xl px-4"><a class="text-link" href="https://callitaday.transistor.fm/">Podcast â†ªï¸Ž</a></li>
    </ul>
</nav>











    </header>

    <main class="mt-16">

        <article class="post">
            <time class="text-textBlue font-bold" datetime="2020-11-13">November 2020</time>
            <h1 class="font-display font-bold text-3xl lg:text-5xl mb-8 text-textBlue"><span class="title-highlight-underline">Laravel Real-Time Notifications</span></h1>

                            <a href="https://christoph-rumpel.com/category/laravel" class="border-black border-2 rounded p-2 uppercase text-link">#laravel</a>
                            <a href="https://christoph-rumpel.com/category/javascript" class="border-black border-2 rounded p-2 uppercase text-link">#javascript</a>
            
            
                        <p class="text-xl lg:text-2xl p-4 lg:p-8 my-8 italic rounded-lg bg-blue-100 border-b-2 border-highlightBlue">
                In this post, we will take a look at how we can send real-time notifications with Laravel, the Laravel Websockets package, and Laravel Echo.
            </p>
                        <div class="post-markdown-styles">
                                    <img class="blogimage" alt="Article banner showing a notification on a website" src="./websocket_tutorial_files/laravel-real-time-notifications-banner.png">
<p>HTTP is stateless. Usually, the client asks for a URL, and the server returns the data. Only a refresh of the page can load new information. Most of the time, this is enough, but sometimes we need more.</p>
<p>Today, many tasks happen on the backend, and we sometimes need to inform the user about it right away. So there is a use-case for <code>triggering an action from the server</code> instead of the client. Think of messaging in a chat or notification messages that pop up on the top of your dashboard.</p>
<p>To achieve this, our client could ask the server every second if something new happened, or you could make use of <code>long polling</code>. But the best solution is to create a <code>new communication channel through WebSockets</code> which works in both ways.</p>
<p>Today we are going to build an application with real-time messaging. We will use a WebSocket solution called <a href="https://beyondco.de/docs/laravel-websockets/">Laravel Websockets</a>, built in PHP.</p>
<p>Here is a preview of what we are going to built today:</p>
<img class="blogimage" alt="Gif showing real-time notifications popping in" src="./websocket_tutorial_files/laravel-real-time-demo.gif">
<p>If you're just interested in the code, check it out <a href="https://github.com/christophrumpel/blog-laravel-real-time-notifications">here</a>.</p>
<h2>Installation</h2>
<p>We start by creating a new Laravel 8 application. I always recommend using the <a href="https://laravel.com/docs/8.x/installation">Laravel Installer</a> for this purpose.</p>
<pre><code class="language-bash hljs bash" data-lang="bash">laravel new laravel-real-time-notifications</code></pre>
<p>To achieve our goal of sending real-time notifications, we need to make three parts work together:</p>
<ul>
<li>Sending/broadcasting notifications from our Laravel application</li>
<li>A WebSockets server that receives those notifications</li>
<li>Our front-end that listens to the WebSockets server</li>
</ul>
<p>Let's start with the WebSockets server.</p>
<h3>Installing Laravel Websockets</h3>
<p>Require the Laravel Websockets package. It works as a replacement for external services like <code>Pusher</code>. Many settings will refer to Pusher today but be reminded that we are not using it. We want our own solution.</p>
<pre><code class="language-bash hljs bash" data-lang="bash">composer require beyondcode/laravel-websockets</code></pre>
<p>We also need a package by Pusher.</p>
<pre><code class="language-bash hljs bash" data-lang="bash">composer require pusher/pusher-php-server</code></pre>
<p>Next, adapt your <code>.env</code> file. We want the <code>BROADCAST_DRIVER</code> to be <code>pusher</code>.</p>
<pre><code class="language-ini hljs ini" data-lang="ini"><span class="hljs-attr">BROADCAST_DRIVER</span>=pusher</code></pre>
<div class="blognote"><strong>Note:</strong> Again I want to mention that we do not use the Pusher service. Our websockets server just has the same API.</div>
<p>And we need to set the Pusher credentials.</p>
<pre><code class="language-ini hljs ini" data-lang="ini"><span class="hljs-attr">PUSHER_APP_ID</span>=<span class="hljs-number">12345</span>
<span class="hljs-attr">PUSHER_APP_KEY</span>=<span class="hljs-number">12345</span>
<span class="hljs-attr">PUSHER_APP_SECRET</span>=<span class="hljs-number">12345</span>
<span class="hljs-attr">PUSHER_APP_CLUSTER</span>=mt1</code></pre>
<p>We can define all those values ourselves. We are not actually using Pusher, but the package uses these keys, so it makes replacing Pusher (if you use it) as simple as possible.</p>
<div class="blognote"><strong>Note:</strong> Make sure to use more random values when using in production.</div>
<p>The Laravel Websockets package comes with a migration file for storing statistics and a config file we need to adapt. Let's publish them.</p>
<pre><code class="language-bash hljs bash" data-lang="bash">php artisan vendor:publish --provider=<span class="hljs-string">"BeyondCode\LaravelWebSockets\WebSocketsServiceProvider"</span> --tag=<span class="hljs-string">"migrations"</span>
</code></pre>
<p>This will create a new migration file that we can run. Make sure you have set up a database for this project and defined the DB credentials in the <code>.env</code> file. Afterward, we can run the migration.</p>
<pre><code class="language-bash hljs bash" data-lang="bash">php artisan migrate</code></pre>
<p>And here, we publish the config file of Laravel Websockets.</p>
<pre><code class="language-bash hljs bash" data-lang="bash">php artisan vendor:publish --provider=<span class="hljs-string">"BeyondCode\LaravelWebSockets\WebSocketsServiceProvider"</span> --tag=<span class="hljs-string">"config"</span></code></pre>
<p>Now we are ready to start the WebSockets server.</p>
<pre><code class="language-bash hljs bash" data-lang="bash">php artisan websockets:serve</code></pre>
<p>To test that it is running, we can check the <code>debugging dashboard</code> under the endpoint <code>/laravel-websockets</code>. You can click connect to see if the dashboard can connect to the WebSockets server.</p>
<img class="blogimage" alt="Laravel Websockets Debug Dashboard" src="./websocket_tutorial_files/laravel-real-time-websockets-connect.png">
<p>After clicking <code>connect</code>, you should see that the dashboard is subscribed to some debugging channels like <code>private-websockets-dashboard-api-message</code>. This will tell you that the server is set up correctly.</p>
<h3>Broadcast Notifications From Our Laravel Application</h3>
<p>There are two ways we can send messages from our backend to the WebSockets server:</p>
<ul>
<li>Laravel Events</li>
<li>Laravel Notifications</li>
</ul>
<p>We will start with events because this is a little easier. Later we will check <a href="https://christoph-rumpel.com/2020/11/laravel-real-time-notifications#notifications">notifications</a> as well.</p>
<p>Let's create a new event with artisan.</p>
<pre><code class="language-bash hljs bash" data-lang="bash">php artisan make:event RealTimeMessage</code></pre>
<p>Here is what we need to change:</p>
<ul>
<li>use the <code>ShouldBroadcast</code> interface</li>
<li>add a message property which we will pass through the constructor</li>
<li>return a new <code>Channel</code> instead of a <code>PrivateChannel</code>
</li>
<li>give the channel the name <code>events</code>  instead of <code>channel-name</code>
</li>
</ul>
<pre><code class="language-php hljs php" data-lang="php"><span class="hljs-meta">&lt;?php</span>

<span class="hljs-keyword">namespace</span> <span class="hljs-title">App</span>\<span class="hljs-title">Events</span>;

<span class="hljs-keyword">use</span> <span class="hljs-title">Illuminate</span>\<span class="hljs-title">Broadcasting</span>\<span class="hljs-title">Channel</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Illuminate</span>\<span class="hljs-title">Contracts</span>\<span class="hljs-title">Broadcasting</span>\<span class="hljs-title">ShouldBroadcast</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Illuminate</span>\<span class="hljs-title">Queue</span>\<span class="hljs-title">SerializesModels</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RealTimeMessage</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">ShouldBroadcast</span>
</span>{
    <span class="hljs-keyword">use</span> <span class="hljs-title">SerializesModels</span>;

    <span class="hljs-keyword">public</span> string $message;

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span><span class="hljs-params">(string $message)</span>
    </span>{
        <span class="hljs-keyword">$this</span>-&gt;message = $message;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">broadcastOn</span><span class="hljs-params">()</span>: <span class="hljs-title">Channel</span>
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Channel(<span class="hljs-string">'events'</span>);
    }
}</code></pre>
<div class="blognote"><strong>Note:</strong> You may noticed that we didn't define a listener like we usually do with an event. This is because we are using the websockets server.</div>
<p>Before we can try sending this event, please adapt your <code>broadcasting.php</code> config file to use the following options:</p>
<pre><code class="language-php hljs php" data-lang="php"><span class="hljs-string">'options'</span> =&gt; [
    <span class="hljs-string">'cluster'</span> =&gt; env(<span class="hljs-string">'PUSHER_APP_CLUSTER'</span>),
    <span class="hljs-string">'encrypted'</span> =&gt; <span class="hljs-keyword">false</span>,
    <span class="hljs-string">'host'</span> =&gt; <span class="hljs-string">'127.0.0.1'</span>,
    <span class="hljs-string">'port'</span> =&gt; <span class="hljs-number">6001</span>,
    <span class="hljs-string">'scheme'</span> =&gt; <span class="hljs-string">'http'</span>
],</code></pre>
<p>With these options, we make sure that when we <code>broadcast</code> something from our Laravel application, it gets sent to our WebSockets server.</p>
<div class="blognote"><strong>Note:</strong> We do not use TLS for our demo, but we will take a look at that later as well.</div>
<p>Now we can trigger our created event <code>RealTimeMessage</code> with the global <code>event</code> helper. I recommend using <code>tinker</code> or <code>Tinkerwell</code> to do that for our demo, but you could also create a route and run the command there.</p>
<pre><code class="language-php hljs php" data-lang="php">event(<span class="hljs-keyword">new</span> App\Events\RealTimeMessage(<span class="hljs-string">'Hello World'</span>));</code></pre>
<p>Of course, in a real application, you would run this inside a controller or action class. After running this command, you should see a new entry on the debug dashboard.</p>
<img class="blogimage" alt="Debug Dashboard showing sent event" src="./websocket_tutorial_files/laravel-real-time-websockets-event-sent.png">
<h3>Listen To Messages From Our Front-end</h3>
<p>We have made sure that our sent event is broadcasted to the WebSockets server. But now we want to listen to it so that we can use the message on our front-end. We are going to use the JavaScript library <code>Laravel Echo</code> for that purpose.</p>
<p>Let's start by installing it together with the pusher library, which we will need as well.</p>
<pre><code class="language-bash hljs bash" data-lang="bash">npm install --save-dev laravel-echo pusher-js</code></pre>
<p>The <code>resouces/js/bootstrap.js</code> file of Laravel already contains a code snippet for creating a new instance of Laravel Echo we can use. Comment it in and add the <code>wsHost</code> and <code>wsPort</code>.</p>
<pre><code class="language-js hljs javascript" data-lang="js"><span class="hljs-keyword">import</span> Echo <span class="hljs-keyword">from</span> <span class="hljs-string">'laravel-echo'</span>;

<span class="hljs-built_in">window</span>.Pusher = <span class="hljs-built_in">require</span>(<span class="hljs-string">'pusher-js'</span>);

<span class="hljs-built_in">window</span>.Echo = <span class="hljs-keyword">new</span> Echo({
    <span class="hljs-attr">broadcaster</span>: <span class="hljs-string">'pusher'</span>,
    <span class="hljs-attr">key</span>: process.env.MIX_PUSHER_APP_KEY,
    <span class="hljs-attr">cluster</span>: process.env.MIX_PUSHER_APP_CLUSTER,
    <span class="hljs-attr">forceTLS</span>: <span class="hljs-literal">false</span>,
    <span class="hljs-attr">wsHost</span>: <span class="hljs-built_in">window</span>.location.hostname,
    <span class="hljs-attr">wsPort</span>: <span class="hljs-number">6001</span>,
});</code></pre>
<p>The <code>bootstrap.js</code> file is required by Laravel's main <code>resources/js/app.js</code> file. This means we need to run <code>npm run dev</code> to bundle our Echo code with the main JS file.</p>
<p>Now import the script. We are going to use Laravel's <code>welcome</code> view for our tutorial. So add the <code>app.js</code> file into your view, right before the end of the body tag.</p>
<pre><code class="language-html hljs xml" data-lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">script <span class="hljs-attr">src=<span class="hljs-string">"{{ asset('js/app.js') }}"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script&gt;</span></span></span></span></code></pre>
<p>Also, open a new script tag where we create our Echo listener. We listen to the channel <code>events</code> and for the class name of the event we created. If we receive an update, we write a message to the console.</p>
<pre><code class="language-html hljs xml" data-lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">script&gt;</span><span class="javascript">
    Echo.channel(<span class="hljs-string">'events'</span>)
        .listen(<span class="hljs-string">'RealTimeMessage'</span>, (e) =&gt; <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'RealTimeMessage: '</span> + e.message));
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script&gt;</span></span></span></code></pre>
<p>When you refresh the browser's welcome page, you should also get an update on the debug dashboard.</p>
<img class="blogimage" alt="Debug Dashboard showing subscribed channel" src="./websocket_tutorial_files/laravel-real-time-websockets-channel-subscribed.png">
<p>It shows that we are successfully subscribed to the <code>events</code> channel. This means we are ready to give it a real try!</p>
<h2>Sending Real-Time Messages</h2>
<p>Now that we prepared our event, the WebSockets server, and our JavaScript listener, we can give a real try. So back inside <code>tinker</code> or <code>Tinkerwell</code>, we can trigger our event again.</p>
<pre><code class="language-php hljs php" data-lang="php">event(<span class="hljs-keyword">new</span> App\Events\RealTimeMessage(<span class="hljs-string">'Hello World'</span>));</code></pre>
<p>Now we not only see the message in the debug dashboard but also in the console output. So we were able to receive data on our front-end, without refreshing the page or making an ajax call. This is our first real-time message. ðŸ¥³</p>
<img class="blogimage" alt="Real time message shown in console output" src="./websocket_tutorial_files/laravel-real-time-console-message.png">
<h2>Let's Talk Privately</h2>
<p>Next to sending messages to a <code>public</code> channel, we can also use a <code>private</code> one with events. Let's change our <code>RealTimeMessage </code> event to use a private channel.</p>
<pre><code class="language-php hljs php" data-lang="php"><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">broadcastOn</span><span class="hljs-params">()</span>: <span class="hljs-title">Channel</span>
</span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> PrivateChannel(<span class="hljs-string">'events'</span>);
}</code></pre>
<p>Now send the event again.</p>
<div class="blognote"><strong>Note:</strong> If you are using Laravel Tinker, make sure to restart it because of the changes we made in our event.</div>
<img class="blogimage" alt="Debug Dashboard showing the message on the private channel" src="./websocket_tutorial_files/laravel-real-time-debug-private-channel.png">
<p>As you can see in the debug dashboard, our message was now sent on a <code>private channel</code>. Nice! But now we also need to listen to a private channel. Luckily, Laravel Echo lets us also change the <code>channel</code> method to <code>private</code>.</p>
<pre><code class="language-js hljs javascript" data-lang="js">Echo.private(<span class="hljs-string">'events'</span>)
    .listen(<span class="hljs-string">'RealTimeMessage'</span>, (e) =&gt; <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Private RealTimeMessage: '</span> + e.message));</code></pre>
<p>But when you refresh the welcome page, you see that we get an error.</p>
<img class="blogimage" alt="Private channel error on our welcome page" src="./websocket_tutorial_files/laravel-real-time-auth-4040.png">
<p>The problem here is that private channels need to be authenticated. That's what Laravel Echo is trying to do by requesting the <code>/broadcasting/auth</code> endpoint. But the endpoint is not defined. We need to include it by uncommenting the <code>BroadcastServericeProvider</code> in our <code>app.php</code> config file.</p>
<pre><code class="language-php hljs php" data-lang="php"><span class="hljs-comment">/*
 * Application Service Providers...
 */</span>
App\Providers\AppServiceProvider::class,
App\Providers\AuthServiceProvider::class,
App\Providers\BroadcastServiceProvider::class, <span class="hljs-comment">// We enabled this class</span>
App\Providers\EventServiceProvider::class,
App\Providers\RouteServiceProvider::class,</code></pre>
<p>Refresh the page again, and you will see the error from before is gone, but of course, there is a new one :-)</p>
<img class="blogimage" alt="419 error in console log" src="./websocket_tutorial_files/laravel-real-time-auth-419.png">
<p>The endpoint is now defined, but it returns a <code>419</code> error. This one is about the <code>csrf</code> token. We need it to verify this request. Here we don't have a form where we usually use it, but we can add it to our HTML head in a meta tag.</p>
<pre><code class="language-html hljs xml" data-lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">meta <span class="hljs-attr">name=<span class="hljs-string">"csrf-token" <span class="hljs-attr">content=<span class="hljs-string">"{{ csrf_token() }}"</span>&gt;</span></span></span></span></span></code></pre>
<p>Again we were able to solve a problem, and also we see a new error. But trust me, we are getting close now :-)</p>
<img class="blogimage" alt="403 broadcast auth error" src="./websocket_tutorial_files/laravel-real-time-auth-403.png">
<p>This time we received a <code>403</code> error telling us we are not allowed to listen to the private channel. This is good because we haven't told Laravel yet who is allowed to listen to this private channel.</p>
<p>Next to the broadcast routes, the BroadcastServiceProvider also activates the <code>routes/channels.php</code> file. Here is where we define who is allowed to access a private channel. There is already an example, but we add our own channel check now.</p>
<pre><code class="language-php hljs php" data-lang="php">Broadcast::channel(<span class="hljs-string">'events'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">($user)</span> </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;
});</code></pre>
<p>We tell Laravel that we do not have specific rules for authenticating who can subscribe to our private channel. But when you refresh the welcome page, you will still see a 403 error. This is because one thing is the same for every private channel: There <code>must be a logged-in user</code>.</p>
<p>So let's add a new user to the database. I'm using Tinkerwell again here. We do not care about the user details.</p>
<pre><code class="language-php hljs php" data-lang="php">User::create([
    <span class="hljs-string">'name'</span> =&gt; <span class="hljs-string">'Test user'</span>,
    <span class="hljs-string">'email'</span> =&gt; <span class="hljs-string">'test@test.at'</span>,
    <span class="hljs-string">'password'</span> =&gt; bcrypt(<span class="hljs-string">'test'</span>),
]);</code></pre>
<p>We can log this user into our application before we return the welcome view in the <code>web.php</code> route file. Also, make sure to import the User class before you use it.</p>
<pre><code class="language-php hljs php" data-lang="php">Route::get(<span class="hljs-string">'/'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
    auth()-&gt;login(User::first());

    <span class="hljs-keyword">return</span> view(<span class="hljs-string">'welcome'</span>);
});</code></pre>
<p>This will log in the first user from our users table. Reload the welcome page, and you will no longer find an error in the console. You will also see that we are now subscribed to the private events channel in the debug dashboard.</p>
<img class="blogimage" alt="Debug Dashboard subscribed to private events channel" src="./websocket_tutorial_files/laravel-real-time-private-channel-subscribed.png">
<p>Trigger the event once again, and we will receive the private message output in the console.</p>
<pre><code class="language-php hljs php" data-lang="php">event(<span class="hljs-keyword">new</span> App\Events\RealTimeMessage(<span class="hljs-string">'Hello World'</span>));</code></pre>
<img class="blogimage" alt="Private message in console output" src="./websocket_tutorial_files/laravel-real-time-private-channel-message-console.png">
<h2 id="notifications">Notifications</h2>
<p>The title of this blog contains <code>Notifications</code>, so what about them? You might know I'm a big fan of Laravel's notification system, so for sure, we are talking about them too.</p>
<p>So next to events, we can use notifications to send data to our WebSockets server. So let's create a new one.</p>
<pre><code class="language-bash hljs bash" data-lang="bash">php artisan make:notification RealTimeNotification</code></pre>
<p>Here is what we need to change:</p>
<ul>
<li>use the <code>ShouldBroadcast</code> interface</li>
<li>add a message property which we will pass through the constructor</li>
<li>use the <code>broadcast</code> channel in the <code>via</code> method</li>
<li>add a <code>toBroadcast</code> method to define the message</li>
</ul>
<pre><code class="language-php hljs php" data-lang="php"><span class="hljs-meta">&lt;?php</span>

<span class="hljs-keyword">namespace</span> <span class="hljs-title">App</span>\<span class="hljs-title">Notifications</span>;

<span class="hljs-keyword">use</span> <span class="hljs-title">Illuminate</span>\<span class="hljs-title">Contracts</span>\<span class="hljs-title">Broadcasting</span>\<span class="hljs-title">ShouldBroadcast</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Illuminate</span>\<span class="hljs-title">Notifications</span>\<span class="hljs-title">Messages</span>\<span class="hljs-title">BroadcastMessage</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Illuminate</span>\<span class="hljs-title">Notifications</span>\<span class="hljs-title">Notification</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RealTimeNotification</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Notification</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">ShouldBroadcast</span>
</span>{

    <span class="hljs-keyword">public</span> string $message;

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span><span class="hljs-params">(string $message)</span>
    </span>{
        <span class="hljs-keyword">$this</span>-&gt;message = $message;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">via</span><span class="hljs-params">($notifiable)</span>: <span class="hljs-title">array</span>
    </span>{
        <span class="hljs-keyword">return</span> [<span class="hljs-string">'broadcast'</span>];
    }

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">toBroadcast</span><span class="hljs-params">($notifiable)</span>: <span class="hljs-title">BroadcastMessage</span>
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> BroadcastMessage([
            <span class="hljs-string">'message'</span> =&gt; <span class="hljs-string">"$this-&gt;message (User $notifiable-&gt;id)"</span>
        ]);
    }
}</code></pre>
<p>Since notifications are always connected to a <code>notifiable</code> model (like a user), we have access to it inside the <code>toBroadcast</code> method. This way I can add the user id to the message we sent.</p>
<div class="blognote"><strong>Note:</strong> There are also on-demand notifications where you do not need a notifiable, but this is not supported in combination with broadcasting.</div>
<p>Alright, time to trigger our notification. Again, we are using the one user we have in our database.</p>
<pre><code class="language-php hljs php" data-lang="php">$user = User::first();

$user-&gt;notify(<span class="hljs-keyword">new</span> App\Notifications\RealTimeNotification(<span class="hljs-string">'Hello World'</span>));</code></pre>
<img class="blogimage" alt="Debug Dashboard showing subscribed to notification channel" src="./websocket_tutorial_files/laravel-real-time-notification-channel-subscribed.png">
<p>You probably noticed that we did not define a channel name with our notification as we did in our event. This is because there is a default pattern for the channel name of a notification <code>notifiable-class.key</code>. In our case, this would be <code>App.Models.User.1</code>. And when you take a look at the Web dashboard, you find a message triggered by our notification to the channel <code>Channel: private-App.Models.User.1</code>.</p>
<p>Next, let's subscribe to this channel in our front-end. Laravel echo has a <code>notification</code> method we can make use of.</p>
<pre><code class="language-js hljs javascript" data-lang="js">Echo.private(<span class="hljs-string">'App.Models.User.1'</span>)
    .notification(<span class="hljs-function">(<span class="hljs-params">notification</span>) =&gt;</span> {
        <span class="hljs-built_in">console</span>.log(notification.message);
    });</code></pre>
<p>You should be able to refresh the welcome page now without seeing any errors. Since we are using a private channel again, Laravel Echo will try to authenticate our subscribing request to this channel. This is where the other code-snippet from the <code>channels.php</code> file comes into play.</p>
<pre><code class="language-php hljs php" data-lang="php">Broadcast::channel(<span class="hljs-string">'App.Models.User.{id}'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">($user, $id)</span> </span>{
    <span class="hljs-keyword">return</span> (int) $user-&gt;id === (int) $id;
});</code></pre>
<p>It will make sure when you try to subscribe to a specific user's private channel that the provided <code>id</code> is the same as the logged-in <code>user</code>. You can easily force an error when you try to listen to a different user id like:</p>
<pre><code class="language-html hljs xml" data-lang="html">Echo.private('App.Models.User.99')
    .notification((notification) =&gt; {
        console.log(notification.message);
    });</code></pre>
<p>When you refresh the welcome page, you will see that we get a <code>403</code> error again. But now, let's finish this example by triggering the notification also now.</p>
<img class="blogimage" alt="Console output showing our notification message" src="./websocket_tutorial_files/laravel-real-time-notifcation-console-output.png">
<p>And this is how we can broadcast real-time messages with notifications as well. The benefit of notifications is that you can send them through multiple channels. So you can send a real-time message to the user's dashboard about a newly created invoice and send an email while only using one notification class.</p>
<h2>More Tips &amp; Tricks</h2>
<h3>SSL Support</h3>
<p>Of course, you will use a secure connection with your live applications. Our example will work there, too, with some additions. Therefore, I have created a new branch called <a href="https://github.com/christophrumpel/blog-laravel-real-time-notifications/compare/feature/useTls">feature/useTls</a>. These settings helped me to make this app work on a secure locally Laravel Valet site.</p>
<div class="blognote"><strong>Note:</strong> If you use this branch, make sure to change the certificate paths to your own ones in the websockets config file.</div>
<p>I saw many users struggling with the SSL support setup with Laravel Websockets and Laravel Echo, and I have to admit it can be tricky because of different SSL settings. I hope my branch will give you a good start. Additionally, <a href="https://beyondco.de/docs/laravel-websockets/basic-usage/ssl">here are the docs</a> for SSL support for Laravel Websockets.</p>
<h3>Events Or Notifications</h3>
<p>As I showed you, both options give you a lot of flexibility when sending real-time messages. I'd recommend notifications if you already work with logged-in users in your application.</p>
<p>If you do not work with users/notifiables in your application, events give you an excellent way of sending messages to a channel you can define.</p>
<h2>Conclusion</h2>
<p>I hope this long article could give you a great start into real-time messaging with Laravel. Am I missing more details? What are your thoughts on Laravel and real-time messaging? Let me know on <a href="https://twitter.com/christophrumpel">Twitter</a>.</p>
<p>As always, make sure to check the official docs for all the tools we used today:</p>
<ul>
<li>
<a href="https://laravel.com/docs/master/broadcasting#defining-broadcast-events">Broadcast Laravel Events</a>
</li>
<li>
<a href="https://laravel.com/docs/master/notifications#broadcast-notifications">Broadcast Laravel Notifications</a>
</li>
<li>
<a href="https://laravel.com/docs/master/broadcasting#installing-laravel-echo">Laravel Echo</a>
</li>
<li>
<a href="https://beyondco.de/docs/laravel-websockets">Laravel Websockets Package</a>
</li>
</ul>
<p>All the code for our demo application can be found in this <a href="https://github.com/christophrumpel/blog-laravel-real-time-notifications">repository</a>.</p>

                

            </div>
        </article>

        <div id="newsletter">
    <div class="max-w-screen-xl mx-auto py-12 lg:py-16">
        <div class="px-6 py-6 bg-textBlue rounded-lg md:py-12 md:px-12 lg:py-16 lg:px-16 xl:flex xl:items-center">
            <div class="xl:w-0 xl:flex-1">
                <h2 class="text-2xl leading-8 font-display tracking-tight text-white sm:text-3xl sm:leading-9">
                    Do you enjoy my posts?
                </h2>
                <p class="mt-3 max-w-3xl text-lg leading-6 text-indigo-200" id="newsletter-headline">
                    Sign up for my newsletter to receive updates on my latest content.
                </p>
            </div>
            <div class="mt-8 sm:w-full sm:max-w-md xl:mt-0 xl:ml-8">
                <form class="sm:flex" aria-labelledby="newsletter-headline" method="POST" action="https://christoph-rumpel.com/mailcoach-subscribe/252362af-c61c-48c3-8482-f71eb019d4f6">
                    <input type="hidden" name="_token" value="5EWvquKHe4Q3XOREr171HXAuI4oqXoOlYdTuQosR">                    <div id="cr_my_name_NEjtDPsfu2oJk6wb_wrap" style="display:none;">
        <input name="cr_my_name_NEjtDPsfu2oJk6wb" type="text" value="" id="cr_my_name_NEjtDPsfu2oJk6wb">
        <input name="valid_from" type="text" value="eyJpdiI6ImVBblZlOEpHdVY2YTN5TCt4cVFxUkE9PSIsInZhbHVlIjoiNWZWMUJTVEl5TXdWMVd5Y25XdzFBZz09IiwibWFjIjoiNzA2YzJkZDE4ODdjMGJmMTkwYWRlNzNmNDhjZWQxNDFlYWY5Yzc1YThhODNkYmU3ZTM0MjQyYjFhNmI4MWI3NCIsInRhZyI6IiJ9">
    </div>
                    <input aria-label="Email address" type="email" name="email" required="" class="appearance-none w-full px-5 py-3 border border-transparent text-base leading-6 rounded-md text-gray-900 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 transition duration-150 ease-in-out" placeholder="Enter your email">
                    <div class="mt-3 rounded-md shadow sm:mt-0 sm:ml-3 sm:flex-shrink-0">
                        <button type="submit" class="w-full flex items-center justify-center px-5 py-3 border border-transparent text-base leading-6 font-medium rounded-md text-white bg-highlightPurple hover:bg-highlightPurpleDark focus:outline-none focus:bg-indigo-400 transition duration-150 ease-in-out">
                            Let's do this
                        </button>
                    </div>
                </form>
                <p class="mt-3 text-sm leading-5 text-indigo-200">
                    You will receive monthly updates on my latest articles and products.
                    I do care about the protection of your data. Read my
                    <a href="https://christoph-rumpel.com/privacy-policy" class="text-white font-medium underline">
                        Privacy Policy.
                    </a>
                </p>
            </div>
        </div>
    </div>
</div>
    </main>
</div>

<footer class="container mx-auto  max-w-5xl px-12">

    <div class="max-w-screen-xl mx-auto py-12 md:flex md:items-center md:justify-between">
        <div class="flex justify-center md:order-2">
            <a href="https://twitter.com/christophrumpel" class="ml-6 text-gray-600 hover:text-gray-500">
        <span class="sr-only">Twitter
        </span>
                <svg class="h-6 w-6" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M8.29 20.251c7.547 0 11.675-6.253 11.675-11.675 0-.178 0-.355-.012-.53A8.348 8.348 0 0022 5.92a8.19 8.19 0 01-2.357.646 4.118 4.118 0 001.804-2.27 8.224 8.224 0 01-2.605.996 4.107 4.107 0 00-6.993 3.743 11.65 11.65 0 01-8.457-4.287 4.106 4.106 0 001.27 5.477A4.072 4.072 0 012.8 9.713v.052a4.105 4.105 0 003.292 4.022 4.095 4.095 0 01-1.853.07 4.108 4.108 0 003.834 2.85A8.233 8.233 0 012 18.407a11.616 11.616 0 006.29 1.84"></path>
                </svg>
            </a>
            <a href="https://github.com/christophrumpel" class="ml-6 text-gray-600 hover:text-gray-500">
        <span class="sr-only">GitHub
        </span>
                <svg class="h-6 w-6" fill="currentColor" viewBox="0 0 24 24">
                    <path fill-rule="evenodd" d="M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0022 12.017C22 6.484 17.522 2 12 2z" clip-rule="evenodd"></path>
                </svg>
            </a>
        </div>
        <div class="mt-8 md:mt-0 md:order-1">
            <p class="text-center text-base leading-6 text-gray-600">
                Â© 2022 Christoph Rumpel, All rights reserved - <a class="underline" href="https://christoph-rumpel.com/privacy-policy">Privacy Policy</a> - <a class="underline" href="https://christoph-rumpel.com/imprint">Imprint</a>
            </p>
        </div>
    </div>
</footer>
<script defer="" src="./websocket_tutorial_files/cdn.min.js.download"></script>

<script defer="" src="./websocket_tutorial_files/cdn.min.js(1).download"></script>



</body></html>